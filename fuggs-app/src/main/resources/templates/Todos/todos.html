{#include main.html}
{#title}Todos - Fuggs Bookkeeping{/title}
{#moreStyles}
<style>
  .todo-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--cds-spacing-05);
    border-bottom: 1px solid var(--cds-border-subtle-01);
  }
  .todo-item:last-child {
    border-bottom: none;
  }
  .add-form {
    display: flex;
    gap: 1rem;
    align-items: flex-end;
  }
  .add-form cds-text-input {
    flex: 1;
  }
</style>
{/moreStyles}

<div class="box">
  <h2 class="box-header">Todos</h2>
  <div class="box-stack">
    {#for todo in todos}
      <div class="todo-item">
        <span>{todo.task.capitalise}</span>
        {#if todo.completed}
          <cds-tag type="green">Done {todo.completed.since}</cds-tag>
        {/if}
      </div>
    {#else}
      <p>No todos yet. Add one below!</p>
    {/for}
  </div>
</div>

<div class="box">
  <h3 class="box-header">Add New Todo</h3>
  {#form uri:Todos.add()}
    <div class="add-form">
      <cds-text-input
        name="task"
        label="Task"
        placeholder="Enter new task"
        {#ifError 'task'}invalid invalid-text="{#error 'task'/}"{/ifError}>
      </cds-text-input>
      <cds-button type="submit">Add</cds-button>
    </div>
  {/form}

  {#ifError 'task'}
    <cds-inline-notification
      kind="error"
      title="Validation Error"
      subtitle="{#error 'task'/}"
      hide-close-button
      style="margin-top: 1rem;">
    </cds-inline-notification>
  {/ifError}
</div>

{/include}
