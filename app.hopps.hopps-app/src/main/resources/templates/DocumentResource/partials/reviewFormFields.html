{@app.hopps.document.domain.Document document}
{@java.util.List<app.hopps.bommel.domain.Bommel> bommels}

<div class="form-section">
  <h3>Belegdaten</h3>
  <div class="form-row">
    <div class="form-group">
      <label for="name">
        Bezeichnung
        {#if document.name != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Bezeichnung</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="text" id="name" name="name" value="{document.name ?: ''}" placeholder="z.B. Büromaterial" class="{#if document.name != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.name != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('name')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('name')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="transactionDate">
        Datum
        {#if document.transactionTime != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Belegdatum</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="date" id="transactionDate" name="transactionDate" value="{document.transactionDateForInput}" class="{#if document.transactionTime != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.transactionTime != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('transactionDate')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('transactionDate')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
  </div>
  <div class="form-row">
    <div class="form-group">
      <label for="total">
        Bruttobetrag *
        {#if document.isTotalPositive && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Gesamtbetrag</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="number" id="total" name="total" step="0.01" required value="{document.total}" class="{#if document.isTotalPositive && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.isTotalPositive && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('total')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('total')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="subTotal">Nettobetrag (berechnet)</label>
      <input type="number" id="subTotal" step="0.01" value="{document.subTotal}" disabled style="background-color: #e0e0e0; color: #525252;">
    </div>
    <div class="form-group">
      <label for="totalTax">
        MwSt
        {#if document.totalTax != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Mehrwertsteuer</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="number" id="totalTax" name="totalTax" step="0.01" value="{document.totalTax}" class="{#if document.totalTax != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.totalTax != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('totalTax')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('totalTax')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="currencyCode">
        Währung
        {#if document.currencyCode != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Währung</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <select id="currencyCode" name="currencyCode" class="{#if document.currencyCode != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
          <option value="EUR" {#if document.currencyCode == 'EUR' || document.currencyCode == null}selected{/if}>EUR</option>
          <option value="USD" {#if document.currencyCode == 'USD'}selected{/if}>USD</option>
          <option value="CHF" {#if document.currencyCode == 'CHF'}selected{/if}>CHF</option>
          <option value="GBP" {#if document.currencyCode == 'GBP'}selected{/if}>GBP</option>
        </select>
        {#if document.currencyCode != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('currencyCode')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('currencyCode')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
  </div>
  <div class="form-row">
    <div class="form-group">
      <label for="bommelId">Bommel zuweisen</label>
      <select id="bommelId" name="bommelId">
        <option value="">— Nicht zugewiesen —</option>
        {#for bommel in bommels}
        <option value="{bommel.id}" {#if document.bommel != null && document.bommel.id == bommel.id}selected{/if}>{bommel.title}</option>
        {/for}
      </select>
    </div>
    <div class="form-group checkbox">
      <input type="checkbox" id="privatelyPaid" name="privatelyPaid" {#if document.privatelyPaid}checked{/if}>
      <label for="privatelyPaid">Privat bezahlt</label>
    </div>
  </div>
</div>

<div class="form-section">
  <h3>Absender</h3>
  <div class="form-row">
    <div class="form-group">
      <label for="senderName">
        Name / Firma
        {#if document.senderName != null && document.senderName != '' && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Absender</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="text" id="senderName" name="senderName" value="{document.senderName}" placeholder="z.B. Lieferant GmbH" class="{#if document.senderName != null && document.senderName != '' && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.senderName != null && document.senderName != '' && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('senderName')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('senderName')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
  </div>
  <div class="form-row">
    <div class="form-group">
      <label for="senderStreet">Straße</label>
      <div class="input-with-clear">
        <input type="text" id="senderStreet" name="senderStreet" value="{document.senderStreet}" class="{#if document.senderStreet != null && document.senderStreet != '' && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.senderStreet != null && document.senderStreet != '' && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('senderStreet')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('senderStreet')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="senderZipCode">PLZ</label>
      <div class="input-with-clear">
        <input type="text" id="senderZipCode" name="senderZipCode" value="{document.senderZipCode}" class="{#if document.senderZipCode != null && document.senderZipCode != '' && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.senderZipCode != null && document.senderZipCode != '' && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('senderZipCode')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('senderZipCode')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="senderCity">Ort</label>
      <div class="input-with-clear">
        <input type="text" id="senderCity" name="senderCity" value="{document.senderCity}" class="{#if document.senderCity != null && document.senderCity != '' && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.senderCity != null && document.senderCity != '' && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('senderCity')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('senderCity')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
  </div>
</div>

<div class="form-section">
  <h3>Rechnungsdetails</h3>
  <div class="form-row">
    <div class="form-group">
      <label for="invoiceId">
        Rechnungsnummer
        {#if document.invoiceId != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Rechnungsnummer</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="text" id="invoiceId" name="invoiceId" value="{document.invoiceId ?: ''}" class="{#if document.invoiceId != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.invoiceId != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('invoiceId')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('invoiceId')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="orderNumber">
        Bestellnummer
        {#if document.orderNumber != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Bestellnummer</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="text" id="orderNumber" name="orderNumber" value="{document.orderNumber ?: ''}" class="{#if document.orderNumber != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.orderNumber != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('orderNumber')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('orderNumber')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
    <div class="form-group">
      <label for="dueDate">
        Fälligkeitsdatum
        {#if document.dueDate != null && document.analysisStatus.name == 'COMPLETED'}
        <cds-ai-label size="mini" autoalign alignment="bottom-left">
          <div slot="body-text" class="ai-explainer">
            <p class="secondary">KI-erkannt</p>
            <p class="secondary bold">Fälligkeitsdatum</p>
            <p class="secondary">Automatisch aus dem Beleg extrahiert.</p>
          </div>
        </cds-ai-label>
        {/if}
      </label>
      <div class="input-with-clear">
        <input type="date" id="dueDate" name="dueDate" value="{document.dueDateForInput}" class="{#if document.dueDate != null && document.analysisStatus.name == 'COMPLETED'}ai-value{/if}">
        {#if document.dueDate != null && document.analysisStatus.name == 'COMPLETED'}
        <button type="button" class="clear-ai-btn" onclick="clearAiValue('dueDate')" title="KI-Wert löschen">
          <svg viewBox="0 0 32 32"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"/></svg>
        </button>
        <button type="button" class="restore-ai-btn" onclick="restoreAiValue('dueDate')" title="KI-Wert wiederherstellen">
          <svg viewBox="0 0 32 32"><path d="M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6 6-6-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"/></svg>
        </button>
        {/if}
      </div>
    </div>
  </div>
</div>

<div class="form-section">
  <h3>
    Tags
    {#if document.hasAiTags}
    <cds-ai-label size="mini" autoalign alignment="bottom-left">
      <div slot="body-text" class="ai-explainer">
        <p class="secondary">KI-generiert</p>
        <p class="secondary bold">Automatische Tags</p>
        <p class="secondary">Diese Tags wurden automatisch basierend auf dem Beleginhalt generiert.</p>
      </div>
    </cds-ai-label>
    {/if}
  </h3>
  <div class="form-row">
    <div class="form-group" style="grid-column: 1 / -1;">
      {#tagInput documentTags=document.documentTags tagsAsString=document.tagsAsString /}
    </div>
  </div>
</div>
