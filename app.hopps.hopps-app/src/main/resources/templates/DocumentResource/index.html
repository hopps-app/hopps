{#include main.html}
{#title}Belege - Hopps Buchhaltung{/title}

{#moreStyles}
<style>
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--cds-spacing-05);
  }
  .page-header h1 {
    margin: 0;
  }
  .documents-table {
    width: 100%;
    border-collapse: collapse;
    background-color: var(--cds-layer-02);
  }
  .documents-table th,
  .documents-table td {
    padding: 0.875rem 1rem;
    text-align: left;
    border-bottom: 1px solid var(--cds-border-subtle-01);
  }
  .documents-table th {
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--cds-text-secondary);
    background-color: var(--cds-layer-01);
  }
  .documents-table tr:hover {
    background-color: var(--cds-background-hover);
  }
  .documents-table a {
    color: var(--cds-link-primary, #0f62fe);
    text-decoration: none;
  }
  .documents-table a:hover {
    text-decoration: underline;
  }
  .doc-type {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 500;
  }
  .doc-type.invoice {
    background: linear-gradient(135deg, #d0e2ff 0%, #a6c8ff 100%);
    color: #0043ce;
  }
  .doc-type.receipt {
    background: linear-gradient(135deg, #defbe6 0%, #a7f0ba 100%);
    color: #0e6027;
  }
  .amount {
    font-weight: 600;
    font-family: 'IBM Plex Mono', monospace;
  }
  .amount.negative {
    color: #da1e28;
  }
  .bommel-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.125rem 0.5rem;
    background: #f4f4f4;
    border-radius: 0.75rem;
    font-size: 0.75rem;
  }
  .empty-state {
    text-align: center;
    padding: var(--cds-spacing-09);
    color: var(--cds-text-secondary);
  }
  .empty-state svg {
    width: 64px;
    height: 64px;
    margin-bottom: var(--cds-spacing-05);
    fill: var(--cds-icon-secondary, #525252);
  }
  a.cds-btn {
    height: 48px;
    padding: 0 1rem;
    border: none;
    font-size: 0.875rem;
    font-weight: 400;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
  }
  a.cds-btn-primary {
    background-color: #0f62fe;
    color: white;
  }
  a.cds-btn-primary:hover {
    background-color: #0353e9;
  }
  .privately-paid {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.125rem 0.5rem;
    background: #fff1f1;
    border-radius: 0.75rem;
    font-size: 0.75rem;
    color: #da1e28;
  }
  .has-file {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.125rem 0.5rem;
    background: linear-gradient(135deg, #d0e2ff 0%, #a6c8ff 100%);
    border-radius: 0.75rem;
    font-size: 0.75rem;
    color: #0043ce;
  }
  .has-file svg {
    width: 12px;
    height: 12px;
    fill: currentColor;
  }
  .tags-cell {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    max-width: 200px;
  }
  .tags-cell cds-tag {
    --cds-layout-size-height: 1.5rem;
  }
  .tags-cell cds-tag[type="purple"] {
    background: linear-gradient(135deg, rgba(105, 41, 196, 0.15) 0%, rgba(166, 108, 255, 0.2) 100%);
    border-color: #8a3ffc;
  }
</style>
{/moreStyles}

<div class="page-header">
  <h1>Belege</h1>
  <a href="/belege/neu" class="cds-btn cds-btn-primary">
    <svg viewBox="0 0 32 32" width="16" height="16" fill="currentColor"><path d="M17 15V7h-2v8H7v2h8v8h2v-8h8v-2z"/></svg>
    Neuer Beleg
  </a>
</div>

<div class="box">
  {#if documents.isEmpty}
    <div class="empty-state">
      <svg viewBox="0 0 32 32"><path d="M25.7 9.3l-7-7A.91.91 0 0 0 18 2H8a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V10a.91.91 0 0 0-.3-.7ZM18 4.4l5.6 5.6H18ZM24 28H8V4h8v6a2 2 0 0 0 2 2h6Z"/><path d="M10 22h12v2H10zM10 16h12v2H10z"/></svg>
      <p>Noch keine Belege vorhanden.</p>
      <a href="/belege/neu" class="cds-btn cds-btn-primary">Ersten Beleg anlegen</a>
    </div>
  {#else}
    <table class="documents-table">
      <thead>
        <tr>
          <th>Typ</th>
          <th>Name / Absender</th>
          <th>Datum</th>
          <th>Betrag</th>
          <th>Bommel</th>
          <th>Tags</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {#for doc in documents}
        <tr>
          <td>
            <span class="doc-type {doc.documentType.name.toLowerCase}">{doc.displayType}</span>
          </td>
          <td><a href="/belege/{doc.id}">{doc.displayName}</a></td>
          <td>{doc.displayDate}</td>
          <td><span class="amount">{doc.displayTotal}</span></td>
          <td>
            {#if doc.bommel}
              <span class="bommel-badge">{doc.bommel.title}</span>
            {#else}
              <span style="color: var(--cds-text-disabled);">—</span>
            {/if}
          </td>
          <td>
            {#if doc.hasTags}
            <div class="tags-cell">
              {#for docTag in doc.documentTags}
              <cds-tag size="sm" type="{#if docTag.aiGenerated}purple{#else}gray{/if}" title="{#if docTag.aiGenerated}KI-generiert{#else}Manuell{/if}">
                {docTag.name}
              </cds-tag>
              {/for}
            </div>
            {#else}
              <span style="color: var(--cds-text-disabled);">—</span>
            {/if}
          </td>
          <td>
            {#if doc.hasFile}
              <span class="has-file">
                <svg viewBox="0 0 32 32"><path d="M25.7 9.3l-7-7A.91.91 0 0 0 18 2H8a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V10a.91.91 0 0 0-.3-.7ZM18 4.4l5.6 5.6H18ZM24 28H8V4h8v6a2 2 0 0 0 2 2h6Z"/></svg>
                Datei
              </span>
            {/if}
            {#if doc.privatelyPaid}
              <span class="privately-paid">Privat bezahlt</span>
            {/if}
          </td>
        </tr>
        {/for}
      </tbody>
    </table>
  {/if}
</div>

{#if flash:success}
  <cds-inline-notification
    kind="success"
    title="Erfolg"
    subtitle="{flash:success}"
    style="position: fixed; bottom: 1rem; right: 1rem;">
  </cds-inline-notification>
{/if}

{#if flash:error}
  <cds-inline-notification
    kind="error"
    title="Fehler"
    subtitle="{flash:error}"
    style="position: fixed; bottom: 1rem; right: 1rem;">
  </cds-inline-notification>
{/if}

{/include}
